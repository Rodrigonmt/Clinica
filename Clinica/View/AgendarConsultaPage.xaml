<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Clinica.View.AgendarConsultaPage"
             BackgroundColor="White"
             Title="Agendar Horário">

    <VerticalStackLayout Padding="15" Spacing="10">


        <!-- Valor -->
        <HorizontalStackLayout Spacing="10"
                       Margin="0,10,0,0"
                       HorizontalOptions="Center">
            <Label Text="Valor Total:"
           FontAttributes="Bold"
           FontSize="18"/>

            <Label x:Name="lblValorTotal"
           Text="R$ 0,00"
           TextColor="#007AFF"
           FontAttributes="Bold"
           FontSize="18"/>
        </HorizontalStackLayout>

        <!-- Data -->
        <Label Text="Escolha a data:" FontSize="18" FontAttributes="Bold" TextColor="Black"/>        
        <DatePicker x:Name="datePicker"
                    Format="dd/MM/yyyy"
                    HorizontalOptions="FillAndExpand"
                    TextColor="Black"
                    BackgroundColor="#D0E8FF"/>

        <!-- Serviços -->
        <Label Text="Selecione os serviços desejados:" 
       FontSize="18" 
       FontAttributes="Bold"
       TextColor="Black"/>

        <Grid>

            <!-- Serviços (2 linhas com scroll horizontal) -->
            <CollectionView x:Name="servicosCollection"
                    SelectionMode="None"
                    HeightRequest="130"
                    Margin="0,5,0,10">

                <CollectionView.ItemsLayout>
                    <GridItemsLayout Orientation="Horizontal"
                             Span="2"
                             HorizontalItemSpacing="12"
                             VerticalItemSpacing="10"/>
                </CollectionView.ItemsLayout>

                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Border WidthRequest="170"
                        Padding="10"
                        Stroke="#E0E0E0"
                        StrokeThickness="1"
                        BackgroundColor="#F9F9F9"
                        StrokeShape="RoundRectangle 12">

                            <HorizontalStackLayout Spacing="10">

                                <CheckBox IsChecked="{Binding Selecionado}"
                                  CheckedChanged="OnServicoChanged"/>

                                <VerticalStackLayout Spacing="2">
                                    <Label Text="{Binding Nome}"
                                   FontSize="15"
                                   FontAttributes="Bold"
                                   TextColor="Black"/>

                                    <Label Text="{Binding Preco, StringFormat='R$ {0:0.00}'}"
                                   FontSize="13"
                                   TextColor="#007AFF"/>
                                </VerticalStackLayout>

                            </HorizontalStackLayout>
                        </Border>
                    </DataTemplate>
                </CollectionView.ItemTemplate>

            </CollectionView>

            <!-- Seta indicativa -->
            <Label Text="›"
           FontSize="36"
           TextColor="#AAAAAA"
           VerticalOptions="Center"
           HorizontalOptions="End"
           Margin="0,0,5,0"
           Opacity="0.6"/>
        </Grid>

        <!-- Médicos -->
        <Label Text="Escolha o Profissional:"
       FontSize="18"
       FontAttributes="Bold"
       TextColor="Black"/>

        <Grid>

            <!-- Lista de profissionais -->
            <ScrollView Orientation="Horizontal"
                HeightRequest="120">

                <HorizontalStackLayout
            x:Name="medicosStack"
            Spacing="15"
            Padding="5,0"/>
            </ScrollView>

            <!-- Seta indicativa -->
            <Label Text="›"
           FontSize="36"
           TextColor="#AAAAAA"
           VerticalOptions="Center"
           HorizontalOptions="End"
           Margin="0,0,5,0"
           Opacity="0.6"/>
        </Grid>


        <!-- Horário -->
        <Label Text="Escolha um horário disponível:" FontSize="18" FontAttributes="Bold" TextColor="Black"/>
        <Picker x:Name="timePicker"
        Title="Selecione o horário"
        HorizontalOptions="FillAndExpand"
        BackgroundColor="#D0E8FF"
        TextColor="Black" />

        <!-- Botão -->
        <Border x:Name="btnAgendar"
        BackgroundColor="#007AFF"
        StrokeThickness="0"
        HeightRequest="50"
        Padding="10"
        HorizontalOptions="FillAndExpand"
        StrokeShape="RoundRectangle 10">
            <Border.GestureRecognizers>
                <TapGestureRecognizer Tapped="OnAgendarConsultaClicked"/>
            </Border.GestureRecognizers>

            <Label Text="Confirmar Agendamento"
           TextColor="White"
           HorizontalOptions="Center"
           VerticalOptions="Center"
           FontSize="18"
           FontAttributes="Bold"/>
        </Border>

        <!-- Observações -->
        <Label Text="Observações (opcional):" 
       FontSize="18" 
       FontAttributes="Bold" 
       TextColor="Black"/>

        <Editor x:Name="txtObservacoes"
        Placeholder="Digite alguma observação..."
        TextColor="Black"
        BackgroundColor="#D0E8FF"
        AutoSize="TextChanges"
        HeightRequest="120"/>
    </VerticalStackLayout>
</ContentPage>
