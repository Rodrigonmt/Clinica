<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Clinica.View.AgendarConsultaPage"
             BackgroundColor="White"
             Shell.NavBarIsVisible="True">

    <!-- ðŸ”¥ Scroll principal da pÃ¡gina -->
    <ScrollView Orientation="Vertical"
                VerticalScrollBarVisibility="Never">

        <VerticalStackLayout Padding="15" Spacing="5">

            <!-- ================= RESUMO ================= -->
            <VerticalStackLayout Spacing="4"
                                 Margin="0,5,0,0"
                                 HorizontalOptions="Center">

                <HorizontalStackLayout Spacing="6">
                    <Label Text="Valor Total:"
                           FontAttributes="Bold"
                           FontSize="18"/>

                    <Label x:Name="lblValorTotal"
                           Text="R$ 0,00"
                           TextColor="#007AFF"
                           FontAttributes="Bold"
                           FontSize="18"/>
                </HorizontalStackLayout>

                <HorizontalStackLayout Spacing="6">
                    <Label Text="Tempo Total:"
                           FontSize="14"
                           TextColor="Gray"/>

                    <Label x:Name="lblTempoTotal"
                           Text="0 min"
                           FontSize="14"
                           FontAttributes="Bold"
                           TextColor="Black"/>
                </HorizontalStackLayout>

            </VerticalStackLayout>

            <!-- ================= DATA ================= -->
            <Label Text="Escolha a data:"
                   FontSize="18"
                   FontAttributes="Bold"
                   TextColor="Black"/>

            <DatePicker x:Name="datePicker"
                        Format="dd/MM/yyyy"
                        HorizontalOptions="FillAndExpand"
                        TextColor="Black"
                        BackgroundColor="#D0E8FF"/>


            <!-- ================= PROFISSIONAIS ================= -->
            <Label Text="Escolha o Profissional:"
               FontSize="18"
               FontAttributes="Bold"
               TextColor="Black"/>

            <Grid>

                <ScrollView Orientation="Horizontal"
                HeightRequest="120"
                HorizontalScrollBarVisibility="Never">

                    <HorizontalStackLayout x:Name="medicosStack"
                               Spacing="15"
                               Padding="5,0"/>
                </ScrollView>

                <!-- Seta indicativa -->
                <Label Text="â€º"
                   FontSize="36"
                   TextColor="#AAAAAA"
                   VerticalOptions="Center"
                   HorizontalOptions="End"
                   Margin="0,0,5,0"
                   Opacity="0.6"/>
            </Grid>

            <!-- ================= SERVIÃ‡OS ================= -->
            <Label Text="Selecione os serviÃ§os desejados:"
                   FontSize="18"
                   FontAttributes="Bold"
                   TextColor="Black"/>

            <Grid>

                <CollectionView x:Name="servicosCollection"
                                SelectionMode="None"
                                HeightRequest="130"
                                Margin="0,5,0,10">

                    <CollectionView.ItemsLayout>
                        <GridItemsLayout Orientation="Horizontal"
                                         Span="2"
                                         HorizontalItemSpacing="12"
                                         VerticalItemSpacing="10"/>
                    </CollectionView.ItemsLayout>

                    <CollectionView.ItemTemplate>
                        <DataTemplate>
                            <Border WidthRequest="170"
                                Padding="10"
                                Stroke="#E0E0E0"
                                StrokeThickness="1"
                                BackgroundColor="#F9F9F9"
                                StrokeShape="RoundRectangle 12"
                                Opacity="{Binding Opacidade}">

                                <HorizontalStackLayout Spacing="10">
                                    <CheckBox IsChecked="{Binding Selecionado}"
                                      IsEnabled="{Binding Habilitado}"
                                      CheckedChanged="OnServicoChanged"/>

                                    <VerticalStackLayout Spacing="2">
                                        <Label Text="{Binding Nome}"
                                       FontSize="15"
                                       FontAttributes="Bold"
                                       TextColor="Black"/>

                                        <Label Text="{Binding Preco, StringFormat='R$ {0:0.00}'}"
                                       FontSize="13"
                                       TextColor="#007AFF"/>
                                    </VerticalStackLayout>
                                </HorizontalStackLayout>

                            </Border>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>


                </CollectionView>

                <!-- Seta indicativa -->
                <Label Text="â€º"
                       FontSize="36"
                       TextColor="#AAAAAA"
                       VerticalOptions="Center"
                       HorizontalOptions="End"
                       Margin="0,0,5,0"
                       Opacity="0.6"/>
            </Grid>

            

            <!-- ================= HORÃRIO ================= -->
            <Label Text="Escolha um horÃ¡rio disponÃ­vel:"
                   FontSize="18"
                   FontAttributes="Bold"
                   TextColor="Black"/>

            <Picker x:Name="timePicker"
                    Title="Selecione o horÃ¡rio"
                    HorizontalOptions="FillAndExpand"
                    BackgroundColor="#D0E8FF"
                    TextColor="Black"/>

            <!-- ================= PAGAMENTO ================= -->
            <Label Text="Forma de pagamento"
               FontSize="18"
               FontAttributes="Bold"
               TextColor="Black"/>

            <Grid>

                <CollectionView x:Name="pagamentosCollection"
                    SelectionMode="Single"
                    HeightRequest="60"
                    HorizontalScrollBarVisibility="Never">

                    <CollectionView.ItemsLayout>
                        <!-- ðŸ”¥ UMA ÃšNICA LINHA HORIZONTAL -->
                        <LinearItemsLayout Orientation="Horizontal"
                               ItemSpacing="10"/>
                    </CollectionView.ItemsLayout>

                    <CollectionView.ItemTemplate>
                        <DataTemplate>
                            <Border StrokeThickness="2"
                        Padding="12"
                        WidthRequest="150"
                        StrokeShape="RoundRectangle 12"
                        BackgroundColor="#F9F9F9">

                                <Label Text="{Binding Nome}"
                           HorizontalOptions="Center"
                           VerticalOptions="Center"
                           FontAttributes="Bold"
                           LineBreakMode="TailTruncation"/>
                            </Border>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>

                <!-- ðŸ‘‰ Seta indicativa -->
                <Label Text="â€º"
                       FontSize="36"
                       TextColor="#AAAAAA"
                       VerticalOptions="Center"
                       HorizontalOptions="End"
                       Margin="0,0,5,0"
                       Opacity="0.6"/>

            </Grid>


            <!-- ================= BOTÃƒO ================= -->
            <Border x:Name="btnAgendar"
                    BackgroundColor="#007AFF"
                    StrokeThickness="0"
                    HeightRequest="50"
                    Padding="10"
                    HorizontalOptions="FillAndExpand"
                    StrokeShape="RoundRectangle 10">

                <Border.GestureRecognizers>
                    <TapGestureRecognizer Tapped="OnAgendarConsultaClicked"/>
                </Border.GestureRecognizers>

                <Label Text="Confirmar Agendamento"
                       TextColor="White"
                       HorizontalOptions="Center"
                       VerticalOptions="Center"
                       FontSize="18"
                       FontAttributes="Bold"/>
            </Border>

            <!-- ================= OBSERVAÃ‡Ã•ES ================= -->
            <Label Text="ObservaÃ§Ãµes (opcional):"
                   FontSize="18"
                   FontAttributes="Bold"
                   TextColor="Black"/>

            <Editor x:Name="txtObservacoes"
                    Placeholder="Digite alguma observaÃ§Ã£o..."
                    TextColor="Black"
                    BackgroundColor="#D0E8FF"
                    AutoSize="TextChanges"
                    HeightRequest="50"/>

        </VerticalStackLayout>

    </ScrollView>
</ContentPage>